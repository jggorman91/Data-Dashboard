<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Behavior Data Collection Dashboard (K-6)</title>
    <style>
        /* General Resets & Base Styles */
        :root {
            --primary-color: #007bff;
            --primary-color-darker: #0056b3;
            --secondary-color: #6c757d;
            --secondary-color-darker: #545b62;
            --danger-color: #dc3545;
            --danger-color-darker: #b02a37;

            --header-bg: #343a40;
            --header-text: #f8f9fa;
            --body-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #333;
            --text-soft-color: #495057;
            --border-color: #ced4da;
            --light-gray-bg: #e9ecef;
            --interactive-highlight: #007bff; /* For tutorial steps, etc. */

            --font-sans-serif: Arial, Helvetica, sans-serif;
            --font-monospace: Consolas, 'Courier New', monospace;

            --spacing-unit: 0.5rem; /* 8px if root font-size is 16px */
            --border-radius-sm: 3px;
            --border-radius-md: 6px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-sans-serif);
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--body-bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Utility Classes */
        .mb-1 { margin-bottom: var(--spacing-unit); }
        .mb-2 { margin-bottom: calc(var(--spacing-unit) * 2); }
        .mt-1 { margin-top: var(--spacing-unit); }
        .mt-2 { margin-top: calc(var(--spacing-unit) * 2); }

        /* Header & Navigation */
        header {
            background-color: var(--header-bg);
            color: var(--header-text);
            padding: calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 4); /* 1rem 2rem */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        header h1 {
            font-size: 1.7rem;
            font-weight: 600;
            white-space: nowrap;
        }

        nav ul {
            list-style-type: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        nav ul li a {
            color: var(--header-text);
            text-decoration: none;
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.6); /* 0.5rem 0.8rem */
            margin: calc(var(--spacing-unit) * 0.4); /* 0.2rem */
            border-radius: var(--border-radius-sm);
            transition: background-color 0.3s ease, color 0.3s ease;
            font-size: 0.9rem;
        }

        nav ul li a:hover,
        nav ul li a.active-nav {
            background-color: var(--primary-color);
            color: white;
        }
        nav ul li a:focus { /* Explicit focus for nav links */
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            background-color: var(--primary-color-darker);
        }


        /* Main Content Area */
        main {
            flex-grow: 1;
            padding: calc(var(--spacing-unit) * 3); /* 1.5rem */
            max-width: 1100px;
            margin: 0 auto;
            width: 100%;
        }

        .dashboard-section {
            background-color: var(--card-bg);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: var(--border-radius-md);
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            margin-bottom: calc(var(--spacing-unit) * 3);
        }
        .dashboard-section[aria-hidden="true"] {
            display: none;
        }
        .dashboard-section[aria-hidden="false"] {
            display: block;
            animation: fadeIn 0.4s ease-in-out;
        }


        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dashboard-section h2 {
            font-size: 1.6rem;
            color: var(--primary-color-darker);
            margin-bottom: calc(var(--spacing-unit) * 2.4); /* 1.2rem */
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: calc(var(--spacing-unit) * 0.8); /* 0.4rem */
        }

        .dashboard-section h3 {
            font-size: 1.3rem;
            color: var(--header-bg);
            margin-top: calc(var(--spacing-unit) * 2.4);
            margin-bottom: calc(var(--spacing-unit) * 1.2); /* 0.6rem */
        }

        .dashboard-section p, .dashboard-section ul, .dashboard-section ol {
            margin-bottom: calc(var(--spacing-unit) * 1.6); /* 0.8rem */
            color: var(--text-soft-color);
            font-size: 0.95rem;
        }

        .dashboard-section ul, .dashboard-section ol {
            padding-left: calc(var(--spacing-unit) * 2.4); /* 1.2rem */
        }
        .dashboard-section li {
            margin-bottom: calc(var(--spacing-unit) * 0.6); /* 0.3rem */
        }

        /* Homepage Specific */
        .method-overview, .best-practice-item {
            margin-bottom: calc(var(--spacing-unit) * 2.4);
            padding: calc(var(--spacing-unit) * 2); /* 1rem */
            border-left: 3px solid var(--primary-color);
            background-color: #fdfdff;
            border-radius: 0 var(--border-radius-sm) var(--border-radius-sm) 0;
        }
        .method-overview h4, .best-practice-item h4 {
            font-size: 1.1rem;
            color: var(--primary-color-darker);
            margin-bottom: calc(var(--spacing-unit) * 0.6);
        }

        /* Resource Section & Interactive Tutorials */
        .tutorial-step {
            background-color: var(--light-gray-bg);
            padding: calc(var(--spacing-unit) * 1.6) calc(var(--spacing-unit) * 2); /* 0.8rem 1rem */
            margin-bottom: var(--spacing-unit);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: background-color 0.2s;
            font-weight: 500;
        }
        .tutorial-step:hover {
            background-color: #ced4da;
        }
        .tutorial-step:focus {
            outline: 2px solid var(--interactive-highlight);
            outline-offset: 1px;
            background-color: #dde2e6;
        }

        .tutorial-content {
            display: none;
            padding: calc(var(--spacing-unit) * 1.6) 0 calc(var(--spacing-unit) * 1.6) calc(var(--spacing-unit) * 2);
            border-left: 2px solid var(--interactive-highlight);
            margin-top: var(--spacing-unit);
            font-size: 0.9rem;
            background-color: #fdfdff;
        }
        .tutorial-content.visible {
            display: block;
        }

        /* Generator Tool & Recommendation Tool Forms */
        .data-form fieldset {
            border: 1px solid var(--border-color);
            padding: calc(var(--spacing-unit) * 2);
            margin-bottom: calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius-sm);
            background-color: #fdfdff;
        }
        .data-form legend {
            font-weight: 600;
            color: var(--primary-color-darker);
            padding: 0 var(--spacing-unit);
            font-size: 1rem;
        }

        .data-form label {
            display: block;
            margin-bottom: calc(var(--spacing-unit) * 0.6);
            font-weight: 600;
            color: var(--text-soft-color);
            font-size: 0.9rem;
        }
        .data-form input[type="checkbox"] {
             margin-right: calc(var(--spacing-unit) * 0.6);
             vertical-align: middle;
        }
        .data-form .checkbox-label { /* For aligning checkbox text */
            display: inline-block;
            font-weight: normal;
            margin-bottom: calc(var(--spacing-unit) * 1.6); /* Same as other inputs */
        }


        .data-form input[type="text"],
        .data-form select,
        .data-form textarea { /* Added textarea */
            width: 100%;
            padding: calc(var(--spacing-unit) * 1.2); /* 0.6rem */
            margin-bottom: calc(var(--spacing-unit) * 1.6);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 0.9rem;
            background-color: var(--card-bg);
        }
        .data-form input:focus, .data-form select:focus, .data-form textarea:focus {
             border-color: var(--primary-color);
             box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
             outline: none;
        }


        .button, button {
            background-color: var(--primary-color);
            color: white;
            padding: calc(var(--spacing-unit) * 1.2) calc(var(--spacing-unit) * 2.4); /* 0.6rem 1.2rem */
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
            text-decoration: none;
            display: inline-block;
            margin-top: var(--spacing-unit);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .button:hover, button:hover {
            background-color: var(--primary-color-darker);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .button:focus, button:focus {
            background-color: var(--primary-color-darker);
            box-shadow: 0 0 0 0.2rem rgba(38,143,255,.5);
            outline: none;
        }


        .button.secondary { background-color: var(--secondary-color); }
        .button.secondary:hover, .button.secondary:focus { background-color: var(--secondary-color-darker); }
        .button.danger { background-color: var(--danger-color); }
        .button.danger:hover, .button.danger:focus { background-color: var(--danger-color-darker); }

        #generatedTemplateOutputContainer, #recommendationResultContainer {
            margin-top: calc(var(--spacing-unit) * 2.4);
            padding: calc(var(--spacing-unit) * 2.4);
            background-color: var(--light-gray-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
        }
        #generatedTemplateOutput {
            white-space: pre-wrap;
            font-family: var(--font-monospace);
            font-size: 0.85rem;
            background-color: var(--card-bg);
            padding: calc(var(--spacing-unit) * 1.6);
            border: 1px solid #ccc;
            border-radius: var(--border-radius-sm);
            max-height: 400px; /* Increased height */
            overflow-y: auto;
        }
        #recommendationResultContainer h4 { /* Shared with generator */
            font-family: var(--font-sans-serif);
            font-size: 1.1rem;
            color: var(--primary-color-darker);
            margin-bottom: calc(var(--spacing-unit) * 0.8);
        }
         #recommendationResultContainer p, #recommendationResultContainer ul {
            font-family: var(--font-sans-serif);
            font-size: 0.95rem;
         }
         #recommendationResultContainer ul {
            list-style-position: inside;
            padding-left: 0;
         }
         #recommendationResultContainer li {
            margin-bottom: calc(var(--spacing-unit) * 0.5);
         }


        /* Footer */
        footer {
            text-align: center;
            padding: calc(var(--spacing-unit) * 2.4);
            background-color: var(--header-bg);
            color: #adb5bd; /* Lighter gray for footer text */
            font-size: 0.85rem;
            margin-top: auto; /* Pushes footer to bottom */
        }
        footer p { margin-bottom: var(--spacing-unit); }
        footer p:last-child { margin-bottom: 0; }


        /* Accessibility */
        .sr-only { /* Screen Reader Only */
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Responsive adjustments */
        @media (max-width: 860px) {
            header {
                flex-direction: column;
                padding: calc(var(--spacing-unit) * 2);
            }
            header h1 {
                margin-bottom: calc(var(--spacing-unit) * 1.6);
                font-size: 1.5rem;
            }
            nav ul {
                flex-direction: column;
                width: 100%;
            }
            nav ul li {
                width: 100%;
                text-align: center;
                margin-bottom: calc(var(--spacing-unit) * 0.4);
            }
            nav ul li a {
                margin-left: 0;
                display: block; /* Make links full width */
            }
        }
        @media (max-width: 600px) {
            main { padding: calc(var(--spacing-unit) * 1.6); }
            .dashboard-section { padding: calc(var(--spacing-unit) * 1.6); }
            .dashboard-section h2 { font-size: 1.3rem; }
            .dashboard-section h3 { font-size: 1.1rem; }
        }

    </style>
</head>
<body>
    <header>
        <h1>K-6 Behavior Data Dashboard</h1>
        <nav>
            <ul>
                <li><a href="#homepage" class="nav-link">Home</a></li>
                <li><a href="#defining-behaviors" class="nav-link">Defining Behaviors</a></li>
                <li><a href="#methods-overview" class="nav-link">Data Methods</a></li>
                <li><a href="#generator-tool" class="nav-link">Template Generator</a></li>
                <li><a href="#recommendation-tool" class="nav-link">Method Recommender</a></li>
                <li><a href="#best-practices" class="nav-link">Best Practices</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="homepage" class="dashboard-section" aria-hidden="true">
            <h2 tabindex="-1">Welcome to the Behavior Data Dashboard!</h2>
            <p>Effective behavior data collection is crucial in K-6 settings for understanding student needs, monitoring progress, and making informed decisions. This dashboard provides resources and tools to help teachers develop starting points for collecting behavior data within a Multi-Tiered System of Supports (MTSS) or Positive Behavioral Interventions and Supports (PBIS) framework.</p>

            <h3>Why Behavior Data?</h3>
            <div class="method-overview">
                <h4>Informed Decision-Making</h4>
                <p>Data enables educators to move beyond subjective impressions and make objective decisions about student support and interventions.</p>
            </div>
            <div class="method-overview">
                <h4>Monitoring Interventions</h4>
                <p>Systematic data collection allows for the evaluation of whether behavioral interventions are effective and leading to desired changes.</p>
            </div>
            <div class="method-overview">
                <h4>IEP Development & Tracking</h4>
                <p>For students in special education, detailed behavior data is essential for developing Functional Behavioral Assessments (FBAs), Behavior Intervention Plans (BIPs), and tracking progress towards Individualized Education Program (IEP) goals.</p>
            </div>
            <div class="method-overview">
                <h4>Identifying Trends</h4>
                <p>Data can reveal patterns in behavior at the individual, class-wide, or school-wide level, helping to identify when and where additional supports may be needed.</p>
            </div>
        </section>

        <section id="defining-behaviors" class="dashboard-section" aria-hidden="true">
            <h2 tabindex="-1">Defining Target Behaviors Operationally</h2>
            <p>The foundation of effective behavior data collection is a clear, objective, and measurable definition of the target behavior. This is known as an operational definition.</p>

            <div class="tutorial-step" data-target="opdef-step1" role="button" tabindex="0" aria-expanded="false" aria-controls="opdef-step1-content">Why Operational Definitions Matter</div>
            <div id="opdef-step1-content" class="tutorial-content">
                <p>An operational definition ensures everyone observing the student is looking for and recording the same thing. It avoids vague terms (e.g., "disruptive," "aggressive") and describes the behavior in a way that is directly observable and measurable. This increases the reliability and consistency of your data.</p>
                <p><em>Example:</em> Instead of "aggressive," define it as "hitting or kicking others with force".</p>
            </div>

            <div class="tutorial-step" data-target="opdef-step2" role="button" tabindex="0" aria-expanded="false" aria-controls="opdef-step2-content">Components of a Good Operational Definition</div>
            <div id="opdef-step2-content" class="tutorial-content">
                <ul>
                    <li><strong>Observable:</strong> The behavior can be seen or heard.</li>
                    <li><strong>Measurable:</strong> The behavior can be counted (frequency, duration, etc.).</li>
                    <li><strong>Clear & Concise:</strong> Unambiguous and easy for anyone to understand so that any two observers would identify it the same way.</li>
                    <li><strong>Includes Examples & Non-Examples (Often):</strong> Clarifies what counts and what doesn't.
                        <ul>
                            <li><em>Example for "Off-Task":</em> "Student is not looking at instructional materials or not engaging in the assigned task for at least 5 consecutive seconds." Includes: looking away from work for >5 seconds, playing with objects unrelated to the task. Excludes: brief glances away, or using approved fidgets quietly while still engaging with the task.</li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="tutorial-step" data-target="opdef-step3" role="button" tabindex="0" aria-expanded="false" aria-controls="opdef-step3-content">Practice: Defining a Behavior</div>
            <div id="opdef-step3-content" class="tutorial-content">
                <p>Let's say you want to track "non-compliance." How would you define it operationally for a 2nd-grade student?</p>
                <p><em>Consider:</em> What does it look like? Sound like? When does it typically occur? What actions would *not* be counted?</p>
                <p><em>Possible Definition (based on common definitions):</em> "Student refusal to follow specific directions or rules (e.g., verbally states 'no,' ignores task requests, or fails to initiate a directed action within 10 seconds of the instruction being given)."</p>
            </div>
        </section>

        <section id="methods-overview" class="dashboard-section" aria-hidden="true">
            <h2 tabindex="-1">Key Behavior Data Collection Methods</h2>
            <p>Several methods can be used to collect behavior data, each with its strengths. Often, a combination of methods provides the most comprehensive picture.</p>

            <div class="tutorial-step" data-target="method-frequency" role="button" tabindex="0" aria-expanded="false" aria-controls="method-frequency-content">Frequency (Event) Recording</div>
            <div id="method-frequency-content" class="tutorial-content">
                <h4>What it is:</h4> <p>Counting how many times a specific, discrete behavior occurs within a defined observation period (e.g., number of call-outs during a 30-minute lesson).</p>
                <h4>Best for:</h4> <p>Behaviors that are discrete and have a clear beginning and end and don't occur so frequently that counting is impossible (e.g., hitting, yells, raising hand, task completion).</p>
                <h4>Tips:</h4> <ul><li>Define the behavior clearly.</li><li>Use simple tally marks, counters, or apps.</li><li>Note the length of the observation period to calculate rate (e.g., occurrences per minute/hour).</li><li>Can be done unobtrusively (e.g., moving a paperclip from one pocket to another).</li></ul>
            </div>

            <div class="tutorial-step" data-target="method-duration" role="button" tabindex="0" aria-expanded="false" aria-controls="method-duration-content">Duration Recording</div>
            <div id="method-duration-content" class="tutorial-content">
                <h4>What it is:</h4> <p>Measuring how long a behavior lasts from its onset to its end (e.g., length of a tantrum, time spent off-task).</p>
                <h4>Best for:</h4> <p>Behaviors where the length of time is the primary concern, or behaviors that are continuous or occur at very high rates such that counting each instance is impractical.</p>
                <h4>Tips:</h4> <ul><li>Requires a timing device (stopwatch, timer app).</li><li>Can calculate total duration (e.g., total minutes off-task in a period) or average duration per occurrence. Can also be reported as a percentage of the observation period.</li><li>Often useful to combine with frequency (e.g., 3 tantrums, average duration 5 minutes).</li><li>It can be challenging for a teacher to track duration while teaching; using a timer with an alarm or assigning another staff member can help.</li></ul>
            </div>

            <div class="tutorial-step" data-target="method-latency" role="button" tabindex="0" aria-expanded="false" aria-controls="method-latency-content">Latency Recording</div>
            <div id="method-latency-content" class="tutorial-content">
                <h4>What it is:</h4> <p>Measuring the time that elapses between a given antecedent (stimulus or instruction) and the onset of the target behavior (e.g., time taken to start a task after being asked).</p>
                <h4>Best for:</h4> <p>Assessing compliance, task initiation, or how quickly a behavior follows a trigger.</p>
                <h4>Tips:</h4> <ul><li>Start timing when the cue/antecedent is delivered and stop when the behavior begins.</li><li>Clearly define what constitutes the "start" of the behavior (e.g. pencil touches paper).</li><li>Reported as an average or range (e.g., "on average, begins assignment 30 seconds after instructions").</li></ul>
            </div>

            <div class="tutorial-step" data-target="method-interval" role="button" tabindex="0" aria-expanded="false" aria-controls="method-interval-content">Interval Recording & Time Sampling</div>
            <div id="method-interval-content" class="tutorial-content">
                <h4>What it is:</h4> <p>Dividing an observation period into short, fixed intervals and recording whether the target behavior occurred. There are two main types: whole-interval (the behavior had to occur continuously for the entire interval to count) and partial-interval (the behavior occurred at least once during the interval). Momentary time sampling involves observing whether the behavior is occurring at precisely the moment each interval ends.</p>
                <h4>Best for:</h4> <p>Behaviors that occur at high frequencies or are continuous/ongoing, making it hard to count every instance (e.g., off-task glancing, fidgeting, social interaction). Provides an estimate of behavior.</p>
                <h4>Tips:</h4> <ul><li>Choose interval length appropriate for the behavior (e.g., 10-30 seconds).</li><li>Partial-interval recording tends to overestimate total behavior occurrence, whereas whole-interval can underestimate.</li><li>Momentary time sampling is convenient for monitoring across a class because the observer doesn't have to watch continuously, but it can miss behaviors that happen outside the exact moment.</li><li>Often reported as a percentage of intervals in which behavior occurred.</li><li>Do not use coarse time sampling for very infrequent behaviors as important events could be missed.</li></ul>
            </div>

            <div class="tutorial-step" data-target="method-abc" role="button" tabindex="0" aria-expanded="false" aria-controls="method-abc-content">ABC Recording (Antecedent-Behavior-Consequence)</div>
            <div id="method-abc-content" class="tutorial-content">
                <h4>What it is:</h4> <p>A narrative observational method where the observer documents the sequence of events: Antecedent (what happened immediately before the behavior), Behavior (the specific actions observed), and Consequence (what happened immediately after, or how others responded).</p>
                <h4>Best for:</h4> <p>Understanding the context and potential function (purpose) of challenging behaviors, often used as part of a Functional Behavior Assessment (FBA) to hypothesize why a behavior is occurring.</p>
                <h4>Tips:</h4> <ul><li>Requires careful, objective, and specific descriptions in note-taking for each incident.</li><li>Collect data across multiple instances (8-10 or more) to identify patterns.</li><li>Can be time- and labor-intensive but provides rich qualitative information for designing effective interventions.</li></ul>
            </div>
        </section>


        <section id="generator-tool" class="dashboard-section data-form" aria-hidden="true">
            <h2 tabindex="-1">Behavior Data Template Generator</h2>
            <p>Create basic templates for behavior data collection. Select a template type and define your fields/elements. Remember to create a clear operational definition for any behavior you plan to track, as this is foundational.</p>
            <form id="templateGeneratorForm">
                <fieldset>
                    <legend>Template Setup</legend>
                    <div>
                        <label for="templateType">Select Template Type:</label>
                        <select id="templateType" name="templateType">
                            <option value="frequencyLog">Frequency Count Log</option>
                            <option value="durationLog">Duration Log</option>
                            <option value="abcChart">ABC Chart</option>
                            <option value="intervalSheet">Interval Recording Sheet (Customizable)</option>
                            <option value="latencyLog">Latency Log</option>
                        </select>
                    </div>
                </fieldset>

                <fieldset id="generatorOptionsContainerWrapper">
                     <legend>Template Details</legend>
                     <div id="generatorOptionsContainer">
                         </div>
                </fieldset>
                <button type="button" id="generateTemplateButton" class="button">Generate Template</button>
            </form>
            <div id="generatedTemplateOutputContainer" style="display:none;" aria-live="polite">
                <h3>Generated Template Preview (Copyable Text):</h3>
                <pre id="generatedTemplateOutput"></pre>
                <button type="button" id="copyTemplateButton" class="button secondary mt-1">Copy to Clipboard</button>
            </div>
        </section>

        <section id="recommendation-tool" class="dashboard-section data-form" aria-hidden="true">
            <h2 tabindex="-1">Behavior Data Method Recommender</h2>
            <p>Answer these questions about the behavior you want to track to get a suggested data collection method as a starting point. This tool helps select appropriate data collection methods based on behavior characteristics and observational context, reflecting expert recommendations.</p>
            <form id="recommendationForm">
                <div id="recommendationQuestionsContainer">
                     </div>
                <button type="button" id="getRecommendationButton" class="button mt-1" style="display:none;">Get Recommendation</button>
            </form>
            <div id="recommendationResultContainer" style="display:none;" aria-live="polite">
                <h4>Recommended Method(s):</h4>
                <p id="recommendedMethod"></p>
                <h4>Reasoning:</h4>
                <ul id="recommendationReasoning"></ul>
            </div>
        </section>

        <section id="best-practices" class="dashboard-section" aria-hidden="true">
            <h2 tabindex="-1">Best Practices for Reliable & Ethical Data Collection</h2>
            <p>Ensuring high-quality data collection is essential for its utility and ethical application.</p>
            <div class="best-practice-item">
                <h4>Use Clear Operational Definitions</h4>
                <p>Always define behaviors in specific, observable, and measurable terms before starting. Ensure all observers use the same definition. For example, "off-task" might be defined as "not looking at instructional materials or not engaging in the assigned task for at least 5 consecutive seconds". Clear definitions improve consistency and objectivity.</p>
            </div>
            <div class="best-practice-item">
                <h4>Train Observers</h4>
                <p>Anyone collecting data should be trained on the definitions and methods. Conduct interobserver reliability (IOR) checks periodically if multiple observers are involved to ensure consistency between people.</p>
            </div>
            <div class="best-practice-item">
                <h4>Be Objective and Minimize Bias</h4>
                <p>Record factual observations (e.g., "Johnny stood up and walked around the room during math for 3 minutes") rather than subjective labels ("Johnny was being annoying"). Using structured data sheets or apps with preset categories can help objectify data. Also, monitor positive behaviors so the focus isn't solely on negatives.</p>
            </div>
            <div class="best-practice-item">
                <h4>Collect Data Consistently</h4>
                <p>Use the same methods and definitions over time, especially when comparing baseline data to intervention data. Determine appropriate frequency of data collection based on need and feasibility, balancing data needs with classroom demands and behavior severity. Tier 1 data might be class-wide weekly/monthly; Tier 2 daily/per period; Tier 3 might require high-frequency data for an FBA/BIP.</p>
            </div>
            <div class="best-practice-item">
                <h4>Ensure Ethical Use and Privacy</h4>
                <p>Treat behavior data as confidential student information. If using digital tools, ensure they comply with privacy laws (like FERPA) and district policies, and store data securely. Only authorized personnel should access individual student behavior data. Obtain parental consent if data collection goes beyond routine classroom practice. Data should be used to help the student, not to label or punish.</p>
            </div>
            <div class="best-practice-item">
                <h4>Focus on Positive Behaviors Too</h4>
                <p>Track improvements and desired behaviors (like instances of following rules or on-task behavior), not just challenging ones. This strengths-based approach can encourage teachers and students by highlighting growth.</p>
            </div>
            <div class="best-practice-item">
                <h4>Use Data to Inform Action</h4>
                <p>Regularly review collected data to make decisions about interventions, supports, and strategies. Data is a tool for positive change and should guide teaching and reinforcement strategies, not just document failure. If data show success, communicate and celebrate it to reinforce the behavior.</p>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; <span id="currentYear"></span> Behavior Data Dashboard Tools. All rights reserved for original content, design, and tools on this site.</p>
        <p>The information and tools provided are for educational and starting-point purposes only to assist teachers. These tools do not constitute behavioral consultation or assessment. Always consult with qualified school personnel (e.g., school psychologist, behavior specialist, special education staff) or a Board Certified Behavior Analyst (BCBA) for individual student assessment, intervention planning, and professional advice.</p>
    </footer>

<script>
// --- Configuration for Generator Options ---
    const generatorFieldConfigurations = {
        frequencyLog: () => `
            <label for="freqBehaviors">Behaviors to Track (comma-separated):</label>
            <input type="text" id="freqBehaviors" name="freqBehaviors" placeholder="e.g., Call out, On-task comment, Hit" required>
            <label for="freqObservationPeriod">Observation Period Length (e.g., 30 minutes, 1 class period):</label>
            <input type="text" id="freqObservationPeriod" name="freqObservationPeriod" placeholder="e.g., 30 minutes reading group">
            <label for="freqOperationalDef">Operational Definition Placeholder (will be included in template):</label>
            <textarea id="freqOperationalDef" name="freqOperationalDef" rows="3" placeholder="Example: Call Out - Any vocalization made by the student, not directed to the teacher during instruction, that is audible to others and not a direct response to a question."></textarea>
        `,
        durationLog: () => `
            <label for="durBehavior">Behavior for Duration Recording:</label>
            <input type="text" id="durBehavior" name="durBehavior" placeholder="e.g., Off-task, Tantrum" required>
            <label for="durOperationalDef">Operational Definition (describe the behavior clearly):</label>
            <textarea id="durOperationalDef" name="durOperationalDef" rows="3" placeholder="Example: Off-Task - Student's eyes are directed away from assigned work, materials, or speaker for more than 5 consecutive seconds."></textarea>
        `,
        abcChart: () => `
            <label for="abcTargetBehavior">Optional: Target Behavior(s) for ABC Chart Focus:</label>
            <input type="text" id="abcTargetBehavior" name="abcTargetBehavior" placeholder="e.g., Physical aggression, Elopement">
            <p class="mb-1" style="font-size: 0.85em; color: var(--text-soft-color);">The ABC chart is used to identify patterns by recording what happens before (Antecedent), the Behavior itself, and what happens after (Consequence).</p>
        `,
        intervalSheet: () => `
            <label for="intervalBehaviorsList">Behaviors to Track (comma-separated, e.g., Talking Out, Out of Seat):</label>
            <input type="text" id="intervalBehaviorsList" name="intervalBehaviorsList" placeholder="e.g., Talking Out, Out of Seat, Hitting" required>
            <label for="intervalBehaviorCodes">Codes for Behaviors (comma-separated, matching order above, e.g., T, OOS, H):</label>
            <input type="text" id="intervalBehaviorCodes" name="intervalBehaviorCodes" placeholder="e.g., T, OOS, H" required>

            <label for="intervalOperationalDef">Operational Definitions (Define each behavior listed above. Be specific!):</label>
            <textarea id="intervalOperationalDef" name="intervalOperationalDef" rows="4" placeholder="Example: Talking Out - Any vocalization not a direct response to teacher/peer & not during approved group talk.\nOut of Seat - Student's hips are not in contact with their assigned seat."></textarea>

            <label for="intervalLength">Interval Length (e.g., 10 seconds, 1 minute, 15 minutes):</label>
            <input type="text" id="intervalLength" name="intervalLength" placeholder="e.g., 15 minutes">
            <label for="totalObservationTime">Total Observation Time (e.g., 2 hours, Full school day):</label>
            <input type="text" id="totalObservationTime" name="totalObservationTime" placeholder="e.g., 2 hours">
            <label for="intervalType">Interval Type (How to score if behavior occurs):</label>
            <select id="intervalType" name="intervalType">
                <option value="partial">Partial Interval (occurs at any time during interval)</option>
                <option value="whole">Whole Interval (occurs for the entire interval)</option>
                <option value="momentary">Momentary Time Sampling (occurs at the moment interval ends)</option>
            </select>

            <div>
                <input type="checkbox" id="includeIntensity" name="includeIntensity">
                <label for="includeIntensity" class="checkbox-label">Include Intensity Rating Column (e.g., 1-5 scale)</label>
            </div>
             <div id="intensityScaleOption" style="display:none;">
                 <label for="intensityScale">Intensity Scale (e.g., 1-3, 1-5):</label>
                 <input type="text" id="intensityScale" name="intensityScale" placeholder="e.g., 1-5 (Low-High)">
             </div>

            <div>
                <input type="checkbox" id="includeLocation" name="includeLocation">
                <label for="includeLocation" class="checkbox-label">Include Location Column</label>
            </div>
            <div>
                <input type="checkbox" id="includeNotes" name="includeNotes">
                <label for="includeNotes" class="checkbox-label">Include General Notes Column per Interval</label>
            </div>
            <script>
                // Show/hide intensity scale input based on checkbox
                const intensityCheckbox = document.getElementById('includeIntensity');
                const intensityScaleDiv = document.getElementById('intensityScaleOption');
                if (intensityCheckbox && intensityScaleDiv) {
                    intensityCheckbox.addEventListener('change', function() {
                        intensityScaleDiv.style.display = this.checked ? 'block' : 'none';
                    });
                }
            <\/script>
        `,
        latencyLog: () => `
            <label for="latBehavior">Behavior for Latency Recording:</label>
            <input type="text" id="latBehavior" name="latBehavior" placeholder="e.g., Starting task after instruction" required>
            <label for="latOperationalDef">Operational Definition (define the *start* of the behavior):</label>
            <textarea id="latOperationalDef" name="latOperationalDef" rows="3" placeholder="Example: Starting Task - Student picks up pencil and places it on the worksheet within the designated area."></textarea>
            <label for="latAntecedent">Antecedent/Prompt (that should initiate the behavior):</label>
            <input type="text" id="latAntecedent" name="latAntecedent" placeholder="e.g., 'Please begin your math worksheet.'">
        `
    };

    // --- Utility Functions ---
    function showSection(sectionId) {
        document.querySelectorAll('.dashboard-section').forEach(section => {
            const isActive = section.id === sectionId;
            section.setAttribute('aria-hidden', String(!isActive));
        });

        const activeSection = document.getElementById(sectionId);
        if (activeSection) {
            const mainHeading = activeSection.querySelector('h2');
            if (mainHeading) {
                mainHeading.focus();
            } else {
                 activeSection.setAttribute('tabindex', '-1'); // Ensure section can be focused if no h2
                 activeSection.focus();
            }
        }
        window.scrollTo(0,0); // Scroll to top when section changes
    }

    function convertToSeconds(timeStr) {
        if (!timeStr || typeof timeStr !== 'string') return 0;
        const timeStrLower = timeStr.toLowerCase().trim();
        // Handle "1 hour", "30 mins", "15 sec" etc.
        const parts = timeStrLower.match(/^(\d+)\s*(sec|min|hour|hr|s|m|h)?s?$/);
        if (!parts) { // Try to parse just number as minutes if no unit, or seconds if small number.
             const val = parseInt(timeStrLower);
             if (isNaN(val)) return 0;
             if (val <= 120) return val; // assume seconds if just number <= 120
             return val * 60; // assume minutes if just number > 120
        }

        const value = parseInt(parts[1]);
        const unit = parts[2];

        if (isNaN(value)) return 0;

        if (unit === 'sec' || unit === 's') return value;
        if (unit === 'min' || unit === 'm') return value * 60;
        if (unit === 'hour' || unit === 'hr' || unit === 'h') return value * 3600;
        // If no unit but value is reasonable for seconds (e.g. "30" for 30 seconds)
        if (!unit && value <= 120) return value;
        // If no unit and value is larger, assume minutes (e.g. "15" for 15 minutes)
        if (!unit) return value * 60; // Default to minutes if unit is unclear but present after number

        return value; // Fallback, though unit parsing should cover most cases
    }


    document.addEventListener('DOMContentLoaded', () => {
        const navLinks = document.querySelectorAll('.nav-link');

        // --- Navigation Click Handling ---
        navLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                showSection(targetId);

                navLinks.forEach(nav => nav.classList.remove('active-nav'));
                event.currentTarget.classList.add('active-nav');
            });
        });

        // --- Initial Page Load Section Setup ---
        let initialSectionId = window.location.hash ? window.location.hash.substring(1) : 'homepage';
        if (!document.getElementById(initialSectionId)) {
            initialSectionId = 'homepage'; // Fallback if hash is invalid
        }

        // Set initial visibility for all sections and active nav link
        document.querySelectorAll('.dashboard-section').forEach(section => {
            if (section.id === initialSectionId) {
                section.setAttribute('aria-hidden', 'false');
            } else {
                section.setAttribute('aria-hidden', 'true');
            }
        });
        navLinks.forEach(link => {
            if (link.getAttribute('href') === `#${initialSectionId}`) {
                link.classList.add('active-nav');
            } else {
                link.classList.remove('active-nav');
            }
        });
        // Focus the heading of the initial section
        const activeInitialSection = document.getElementById(initialSectionId);
        if (activeInitialSection) {
            const mainHeading = activeInitialSection.querySelector('h2');
            if (mainHeading) {
                mainHeading.focus();
            } else {
                 activeInitialSection.setAttribute('tabindex', '-1');
                 activeInitialSection.focus();
            }
        }

        // --- Interactive Tutorial Logic ---
        document.querySelectorAll('.tutorial-step').forEach(step => {
            step.addEventListener('click', () => {
                const targetId = step.dataset.target;
                const content = document.getElementById(targetId + '-content');
                if (content) {
                    const isVisible = content.classList.toggle('visible');
                    step.setAttribute('aria-expanded', String(isVisible));
                }
            });
            // Allow keyboard activation for tutorial steps
            step.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    step.click();
                }
            });
        });

        // --- Template Generator Logic ---
        const templateTypeSelect = document.getElementById('templateType');
        const generatorOptionsContainer = document.getElementById('generatorOptionsContainer');
        const generateTemplateButton = document.getElementById('generateTemplateButton');
        const generatedTemplateOutput = document.getElementById('generatedTemplateOutput');
        const generatedTemplateOutputContainer = document.getElementById('generatedTemplateOutputContainer');
        const copyTemplateButton = document.getElementById('copyTemplateButton');

        function updateGeneratorOptions() {
            if (!generatorOptionsContainer || !templateTypeSelect) return;
            const type = templateTypeSelect.value;
            if (generatorFieldConfigurations[type]) {
                generatorOptionsContainer.innerHTML = generatorFieldConfigurations[type]();
                 // Re-attach event listener for intensity checkbox if intervalSheet is selected
                if (type === 'intervalSheet') {
                    const intensityCheckbox = document.getElementById('includeIntensity');
                    const intensityScaleDiv = document.getElementById('intensityScaleOption');
                    if (intensityCheckbox && intensityScaleDiv) {
                        intensityCheckbox.addEventListener('change', function() {
                            intensityScaleDiv.style.display = this.checked ? 'block' : 'none';
                        });
                        // Ensure it's correctly displayed on subsequent selections if already checked
                        intensityScaleDiv.style.display = intensityCheckbox.checked ? 'block' : 'none';
                    }
                }
            } else {
                generatorOptionsContainer.innerHTML = '<p>Select a template type to see options.</p>';
            }
        }

        if (templateTypeSelect) {
            templateTypeSelect.addEventListener('change', updateGeneratorOptions);
            updateGeneratorOptions(); // Initial call to populate based on default selection
        }

        if (generateTemplateButton) {
            generateTemplateButton.addEventListener('click', () => {
                const form = document.getElementById('templateGeneratorForm');
                if (!form.checkValidity()) {
                    form.reportValidity(); // Show HTML5 validation messages
                    return;
                }

                const type = templateTypeSelect.value;
                let output = `Data Collection Template: ${type.replace(/([A-Z])/g, ' $1').trim()}\n\n`; // Add space before capital letters for display
                output += `Student: _________________________ Date: ______________ Observer: ______________\n`;
                output += `Setting: _________________________ Time Start: _________ Time End: __________\n\n`;

                let operationalDefText = "";
                const opDefInputId = type.startsWith('freq') ? 'freqOperationalDef' :
                                     type.startsWith('dur') ? 'durOperationalDef' :
                                     type.startsWith('interval') ? 'intervalOperationalDef' :
                                     type.startsWith('lat') ? 'latOperationalDef' : null;

                if (opDefInputId && document.getElementById(opDefInputId)) {
                    operationalDefText = document.getElementById(opDefInputId).value.trim();
                }


                let mainBehaviorName = "Target Behavior"; // Default
                if (type === 'frequencyLog') {
                    mainBehaviorName = document.getElementById('freqBehaviors')?.value.trim() || "Not Specified";
                } else if (type === 'durationLog') {
                    mainBehaviorName = document.getElementById('durBehavior')?.value.trim() || "Not Specified";
                } else if (type === 'intervalSheet') {
                    mainBehaviorName = document.getElementById('intervalBehaviorsList')?.value.trim() || "Not Specified";
                } else if (type === 'latencyLog') {
                    mainBehaviorName = document.getElementById('latBehavior')?.value.trim() || "Not Specified";
                } else if (type === 'abcChart') {
                    mainBehaviorName = document.getElementById('abcTargetBehavior')?.value.trim() || ""; // ABC can be general
                }


                if (type !== 'abcChart' || (type === 'abcChart' && mainBehaviorName && mainBehaviorName !== "")) {
                     output += `Target Behavior(s): ${mainBehaviorName}\n`;
                }


                if (operationalDefText) {
                    output += `Operational Definition(s):\n${operationalDefText}\n________________________________________________________________________________\n\n`;
                } else if (type !== 'abcChart') {
                    output += `Operational Definition(s): [Remember to define each behavior in clear, observable, and measurable terms.]\n________________________________________________________________________________\n\n`;
                }


                switch (type) {
                    case 'frequencyLog':
                        const behaviors = (document.getElementById('freqBehaviors')?.value || 'Behavior 1').split(',').map(b => b.trim());
                        const obsPeriod = document.getElementById('freqObservationPeriod')?.value || 'N/A';
                        output += `Observation Period: ${obsPeriod}\n(Method described in)\n\n`;
                        output += `| Behavior Tracked         | Tallies                                   | Total |\n`;
                        output += `|--------------------------|-------------------------------------------|-------|\n`;
                        behaviors.forEach(b => {
                            output += `| ${b.padEnd(24)} |                                           |       |\n`;
                        });
                        output += `\nNotes/Context:\n`;
                        break;
                    case 'durationLog':
                        output += `(Method described in)\n`;
                        output += `| Start Time | End Time   | Duration   | Notes/Context (What was happening?) |\n`;
                        output += `|------------|------------|------------|-------------------------------------|\n`;
                        for(let i=0; i<5; i++) output += `|            |            |            |                                     |\n`;
                        output += `\nTotal Duration: _____________\nAverage Duration: ____________`;
                        break;
                    case 'abcChart':
                        output += `Instructions: For each observed instance of the target behavior(s), describe what happened just before (Antecedent), the Behavior itself, and what happened right after (Consequence). (Method described in)\n\n`
                        output += `| Date/Time | Setting/Activity | Antecedent (What happened BEFORE?)                       | Behavior (What did student DO - be specific) | Consequence (What happened AFTER? How did others react?) |\n`;
                        output += `|-----------|------------------|--------------------------------------------------------|----------------------------------------------|----------------------------------------------------------|\n`;
                        for(let i=0; i<5; i++) output += `|           |                  |                                                        |                                              |                                                          |\n`;
                        output += `\nPossible Function/Purpose Hypothesis (Why do you think the behavior is occurring? e.g., to get attention, escape task, get item):\n`;
                        break;
                    case 'intervalSheet':
                        const behaviorNamesStr = document.getElementById('intervalBehaviorsList')?.value || 'Behavior1';
                        const behaviorCodesStr = document.getElementById('intervalBehaviorCodes')?.value || 'B1';
                        const intervalLength = document.getElementById('intervalLength')?.value || '15 min';
                        const totalTime = document.getElementById('totalObservationTime')?.value || '1 hour';
                        const intervalTypeVal = document.getElementById('intervalType')?.value || 'partial';

                        const includeIntensity = document.getElementById('includeIntensity')?.checked;
                        const intensityScale = includeIntensity ? (document.getElementById('intensityScale')?.value || '1-5') : '';
                        const includeLocation = document.getElementById('includeLocation')?.checked;
                        const includeNotes = document.getElementById('includeNotes')?.checked;

                        const behaviorNames = behaviorNamesStr.split(',').map(s => s.trim());
                        const behaviorCodes = behaviorCodesStr.split(',').map(s => s.trim());

                        output += `Target Behaviors & Codes:\n`;
                        if (behaviorNames.length === behaviorCodes.length) {
                            behaviorNames.forEach((name, idx) => {
                                output += `  - ${name}: ${behaviorCodes[idx]}\n`;
                            });
                        } else {
                            output += `  - Error: Mismatch between number of behaviors and codes provided.\n`;
                        }
                        // Operational definitions already added if provided

                        output += `\nInterval Type: ${intervalTypeVal.charAt(0).toUpperCase() + intervalTypeVal.slice(1)} Interval Recording\n`;
                        output += `Interval Length: ${intervalLength}\nTotal Observation Time: ${totalTime}\n(Method described in)\n\n`;

                        output += `Key: For each behavior, mark if it occurred according to the interval type using its code.\n`;
                        behaviorNames.forEach((name, idx) => {
                             if (behaviorCodes[idx]) output += `     ${behaviorCodes[idx]} = ${name}\n`;
                        });
                        output += `\n`;

                        let tableHeader = "| Interval # | Time  | Behavior Codes Observed ";
                        let dividerLine = "|------------|-------|-------------------------";
                        let exampleRow =  "|            |       |                         ";

                        if (includeIntensity) {
                            tableHeader += `| Intensity (${intensityScale}) `;
                            dividerLine += `|-------------------`;
                            exampleRow  += `|                   `;
                        }
                        if (includeLocation) {
                            tableHeader += `| Location `;
                            dividerLine += `|----------`;
                            exampleRow  += `|          `;
                        }
                        if (includeNotes) {
                            tableHeader += `| Notes                               `;
                            dividerLine += `|-------------------------------------`;
                            exampleRow  += `|                                     `;
                        }
                        tableHeader += "|\n";
                        dividerLine += "|\n";
                        exampleRow  += "|\n";

                        output += tableHeader;
                        output += dividerLine;

                        let numIntervals = 10; // Default
                        try {
                            const totalSeconds = convertToSeconds(totalTime);
                            const intervalSecondsValNum = convertToSeconds(intervalLength);
                            if (totalSeconds > 0 && intervalSecondsValNum > 0) {
                                numIntervals = Math.floor(totalSeconds / intervalSecondsValNum);
                            } else if (totalSeconds > 0 && !intervalSecondsValNum) { // if interval length not parsable, but total time is
                                numIntervals = 10; // default to 10 if interval length bad
                            } else if (!totalSeconds && intervalSecondsValNum > 0) { // if total time not parsable
                                numIntervals = 10; // default to 10
                            }
                        } catch (e) { /* Use default numIntervals */ }
                        numIntervals = Math.max(1, numIntervals); // Ensure at least 1 interval

                        let currentTime = 0; // in seconds
                        const intervalSeconds = convertToSeconds(intervalLength);

                        for (let k = 1; k <= numIntervals ; k++) {
                            let timeDisplay;
                            if (intervalSeconds > 0) {
                                const hours = Math.floor(currentTime / 3600);
                                const minutes = Math.floor((currentTime % 3600) / 60);
                                const seconds = currentTime % 60;
                                if (hours > 0) {
                                   timeDisplay = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                                } else {
                                   timeDisplay = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                                }
                                currentTime += intervalSeconds;
                            } else {
                                timeDisplay = "N/A";
                            }

                            let intervalRow = `| ${String(k).padEnd(10)} | ${timeDisplay.padEnd(5)} |                         `;
                            if (includeIntensity) intervalRow += `|                   `;
                            if (includeLocation)  intervalRow += `|          `;
                            if (includeNotes)     intervalRow += `|                                     `;
                            intervalRow += "|\n";
                            output += intervalRow;
                        }

                        output += `\nSummary:\n`;
                         behaviorCodes.forEach(code => {
                            if(code) output += `Total Intervals with ${code}: ______ Percentage for ${code}: ______ %\n`;
                        });
                        break;
                    case 'latencyLog':
                        const antecedent = document.getElementById('latAntecedent')?.value || 'Instruction given';
                        output += `Antecedent/Prompt: ${antecedent}\n(Method described in)\n\n`;
                        output += `| Time of Prompt | Time Behavior Began | Latency (Time Elapsed) | Notes (Context, what did student do during latency) |\n`;
                        output += `|----------------|---------------------|------------------------|-----------------------------------------------------|\n`;
                        for(let i=0; i<5; i++) output += `|                |                     |                        |                                                     |\n`;
                        output += `\nAverage Latency: ____________`;
                        break;
                }
                generatedTemplateOutput.textContent = output;
                generatedTemplateOutputContainer.style.display = 'block';
            });
        }


        if (copyTemplateButton) {
            copyTemplateButton.addEventListener('click', () => {
                if (navigator.clipboard && generatedTemplateOutput.textContent) {
                    navigator.clipboard.writeText(generatedTemplateOutput.textContent)
                        .then(() => alert('Template copied to clipboard!'))
                        .catch(err => {
                            console.error('Failed to copy: ', err);
                            alert('Failed to copy. Your browser might not support this feature or permissions may be denied.');
                        });
                } else {
                    alert('Clipboard API not available or no template to copy.');
                }
            });
        }

        // --- Recommendation Tool Logic ---
        const recQuestionsContainer = document.getElementById('recommendationQuestionsContainer');
        const getRecButton = document.getElementById('getRecommendationButton');
        const recResultDiv = document.getElementById('recommendationResultContainer');
        const recMethodP = document.getElementById('recommendedMethod');
        const recReasoningUl = document.getElementById('recommendationReasoning');

        let currentRecQuestionIndex = 0;
        const userRecAnswers = {};

        function displayRecQuestion(index) {
            if (!recQuestionsContainer) return;

            if (index < behaviorRecQuestionsConfig.length) {
                const qConfig = behaviorRecQuestionsConfig[index];

                let qGroup = document.getElementById(`q-group-${qConfig.id}`);
                if (!qGroup) { // Only create if it doesn't exist
                    qGroup = document.createElement('fieldset');
                    qGroup.id = `q-group-${qConfig.id}`;
                    qGroup.className = 'mb-2';

                    const legend = document.createElement('legend');
                    legend.textContent = qConfig.text;
                    qGroup.appendChild(legend);

                    const selectEl = document.createElement('select');
                    selectEl.id = qConfig.id;
                    selectEl.name = qConfig.id;
                    qConfig.options.forEach(opt => {
                        const optionEl = document.createElement('option');
                        optionEl.value = opt.value;
                        optionEl.textContent = opt.text;
                        selectEl.appendChild(optionEl);
                    });

                    qGroup.appendChild(selectEl);
                    recQuestionsContainer.appendChild(qGroup);

                    selectEl.addEventListener('change', (event) => {
                        userRecAnswers[qConfig.id] = event.target.value;

                        // Check if all questions up to this one (inclusive) are answered
                        let allPreviousAnswered = true;
                        for(let i = 0; i <= index; i++) {
                            if(!userRecAnswers[behaviorRecQuestionsConfig[i].id] || userRecAnswers[behaviorRecQuestionsConfig[i].id] === "") {
                                allPreviousAnswered = false;
                                break;
                            }
                        }

                        if (allPreviousAnswered && index + 1 < behaviorRecQuestionsConfig.length) {
                            displayRecQuestion(index + 1); // Show next question if current one answered
                        }

                        // Check if ALL questions are answered to show button
                        const allAnswered = behaviorRecQuestionsConfig.every(q => userRecAnswers[q.id] && userRecAnswers[q.id] !== "");
                        if (allAnswered && getRecButton) {
                            getRecButton.style.display = 'inline-block';
                        } else if (getRecButton) {
                             getRecButton.style.display = 'none';
                        }
                    });
                }
                // If not all questions are answered, ensure button is hidden
                 const allAnsweredCheck = behaviorRecQuestionsConfig.every(q => userRecAnswers[q.id] && userRecAnswers[q.id] !== "");
                 if (!allAnsweredCheck && getRecButton) {
                       getRecButton.style.display = 'none';
                 }
            }
        }

        if (getRecButton) {
            getRecButton.addEventListener('click', () => {
                let recommendations = new Set();
                let reasoningPoints = [];
                const { behaviorNature, infoNeeded, observerAvailability } = userRecAnswers;

                // Ensure all answers are provided
                if (!behaviorNature || !infoNeeded || !observerAvailability || behaviorNature === "" || infoNeeded === "" || observerAvailability === "") {
                    alert("Please answer all questions to get a recommendation.");
                    return;
                }

                if (infoNeeded === 'whenAndWhy') {
                    recommendations.add("ABC Recording");
                    reasoningPoints.push("To understand the context, potential triggers (Antecedents), and outcomes (Consequences) which helps hypothesize the function of the behavior, ABC Recording is the primary method. This is often used for Tier 3 assessments.");
                }
                if (behaviorNature === 'responseLag') {
                    recommendations.add("Latency Recording");
                    reasoningPoints.push("When the main concern is the time delay between a prompt/instruction and the start of the behavior, Latency Recording directly measures this.");
                }
                if (behaviorNature === 'discrete') {
                    if (infoNeeded === 'howOften') {
                        recommendations.add("Frequency (Event) Recording");
                        reasoningPoints.push("For behaviors with a clear start and end, Frequency Recording counts how many times it occurs, which is ideal for tracking increases or decreases.");
                    }
                    if (infoNeeded === 'howLong' && !recommendations.has("Duration Recording")) {
                        recommendations.add("Duration Recording");
                        reasoningPoints.push("If the length of each discrete instance is important (e.g., short vs. long episodes of a specific action), use Duration Recording.");
                    }
                }
                 if (behaviorNature === 'continuous' || (behaviorNature === 'discrete' && infoNeeded === 'proportionOfTime')) {
                    if (infoNeeded === 'howLong' || infoNeeded === 'proportionOfTime') {
                        if (!recommendations.has("Duration Recording")) {
                             recommendations.add("Duration Recording");
                             reasoningPoints.push("For continuous behaviors, or when the total time spent in a behavior is key, Duration Recording is suitable.");
                        }
                    }
                    // This condition suggests Interval or MTS
                    if (infoNeeded === 'proportionOfTime' || observerAvailability === 'intermittentMultitasking' || behaviorNature === 'continuous') {
                        if (observerAvailability === 'intermittentMultitasking' && behaviorNature === 'continuous') {
                             recommendations.add("Momentary Time Sampling");
                             reasoningPoints.push("For ongoing behaviors where the observer is multitasking, Momentary Time Sampling is convenient as it requires checking only at specific moments.");
                        } else {
                            recommendations.add("Interval Recording (Partial or Whole)");
                            reasoningPoints.push("For high-frequency or ongoing behaviors, or if continuous observation is difficult, Interval Recording (Partial or Whole) can provide an estimate of behavior occurrence. Partial may overestimate, Whole may underestimate.");
                             if (!recommendations.has("Momentary Time Sampling")) { // Offer MTS as an alternative if Interval is already primary
                                recommendations.add("Momentary Time Sampling (as an alternative)");
                                reasoningPoints.push("Momentary Time Sampling can also be used and is often less demanding for observers.");
                             }
                        }
                    }
                }
                if (recommendations.size === 0) {
                     recommendations.add("Direct Observation with Anecdotal Notes, then refine.");
                     reasoningPoints.push("If the behavior is complex or the best measurement isn't immediately clear, start with detailed narrative (anecdotal) notes during direct observation. This can help clarify the behavior's characteristics and guide the selection of a more specific data collection method later.");
                }
                if (recommendations.has("Frequency (Event) Recording") && recommendations.has("Duration Recording") && recommendations.size <= 3) {
                    reasoningPoints.push("Often, combining Frequency and Duration Recording gives a more complete picture (e.g., how many times a behavior occurred and how long each instance lasted).");
                }
                if (recommendations.has("ABC Recording") && recommendations.size > 1 && recommendations.size <=3 ) {
                    reasoningPoints.push("ABC data can be supplemented with quantitative measures (like Frequency or Duration) to provide both contextual understanding and measurable change over time.");
                }


                recMethodP.textContent = recommendations.size > 0 ? Array.from(recommendations).join('; or ') : "Could not determine a primary recommendation. Consider direct observation and anecdotal notes first.";

                recReasoningUl.innerHTML = ''; // Clear previous reasoning
                reasoningPoints.forEach(point => {
                    const li = document.createElement('li');
                    li.textContent = point;
                    recReasoningUl.appendChild(li);
                });
                recResultDiv.style.display = 'block';
            });
        }

        // Initialize the first question for the recommendation tool
        if (recQuestionsContainer) displayRecQuestion(currentRecQuestionIndex);

        // --- Footer Year ---
        const currentYearSpan = document.getElementById('currentYear');
        if (currentYearSpan) currentYearSpan.textContent = new Date().getFullYear();
    });
</script>
</body>
</html>
